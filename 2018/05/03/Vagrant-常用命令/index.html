<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Vagrant 常用命令"><meta name="keywords" content=""><meta name="author" content="kuops,undefined"><meta name="copyright" content="kuops"><title>Vagrant 常用命令 | Kuops Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.4"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  localSearch: undefined
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#box"><span class="toc-number">1.</span> <span class="toc-text">box</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#destroy"><span class="toc-number">2.</span> <span class="toc-text">destroy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#global-status"><span class="toc-number">3.</span> <span class="toc-text">global-status</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#halt"><span class="toc-number">4.</span> <span class="toc-text">halt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#init"><span class="toc-number">5.</span> <span class="toc-text">init</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#package"><span class="toc-number">6.</span> <span class="toc-text">package</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#port"><span class="toc-number">7.</span> <span class="toc-text">port</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reload"><span class="toc-number">8.</span> <span class="toc-text">reload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Suspend"><span class="toc-number">9.</span> <span class="toc-text">Suspend</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Resume"><span class="toc-number">10.</span> <span class="toc-text">Resume</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Snapshot"><span class="toc-number">11.</span> <span class="toc-text">Snapshot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssh"><span class="toc-number">12.</span> <span class="toc-text">ssh</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#status"><span class="toc-number">13.</span> <span class="toc-text">status</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#up"><span class="toc-number">14.</span> <span class="toc-text">up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vagrant-多台主机"><span class="toc-number">15.</span> <span class="toc-text">vagrant 多台主机</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#控制多台机器"><span class="toc-number">15.1.</span> <span class="toc-text">控制多台机器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络"><span class="toc-number">15.2.</span> <span class="toc-text">网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自启动"><span class="toc-number">15.3.</span> <span class="toc-text">自启动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vagrant-Plugin"><span class="toc-number">16.</span> <span class="toc-text">Vagrant Plugin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CentOS-自定义镜像错误"><span class="toc-number">17.</span> <span class="toc-text">CentOS 自定义镜像错误</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.jpg"></div><div class="author-info__name text-center">kuops</div><div class="author-info__description text-center">巧者劳而智者忧，无能者无所求</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">36</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">5</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1529517901642&amp;di=5f7db410ab487b78dd0afc85bc246702&amp;imgtype=0&amp;src=http%3A%2F%2Fimg5.duitang.com%2Fuploads%2Fitem%2F201610%2F21%2F20161021234613_KvFXP.jpeg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Kuops Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">Vagrant 常用命令</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-05-03</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/vagrant/">vagrant</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><h2 id="box"><a href="#box" class="headerlink" title="box"></a>box</h2><p>用于添加删除 box 等，又以下子命令</p>
<ul>
<li>add</li>
<li>list</li>
<li>outdated</li>
<li>prune</li>
<li>remove</li>
<li>repackage</li>
<li>update</li>
</ul>
<p><strong>Box Add</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant box add ADDRESS</span><br></pre></td></tr></table></figure></p>
<p>addreess 可以是以下三种任意一种：</p>
<ul>
<li>Vagrant 公共镜像简写名称 ，如 “hashicorp/precise64”。</li>
<li>文件路径或 <code>HTTP URL</code> 到目录中的框。对于HTTP，支持基本身份验证并且支持通过 <code>http_proxy</code> 变量进行下载 。HTTPS也受支持。</li>
<li>网址直接一个盒子文件。在这种情况下，您必须指定一个 <code>--name</code> 标志，版本控制/更新将不起作用。</li>
</ul>
<p><strong>其他子命令</strong></p>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>vagrant box list</td>
<td>列出当前所有的 box</td>
</tr>
<tr>
<td>vagrant box outdated</td>
<td>告诉你当前 vagrant 环境中使用的 box 是否过期</td>
</tr>
<tr>
<td>vagrant box prune</td>
<td>清理旧版本的 box，如果当前 box 正在使用，则要求使用者确认</td>
</tr>
<tr>
<td>vagrant box remove NAME</td>
<td>从Vagrant 中删除与给定名称相匹配的 box</td>
</tr>
<tr>
<td>vagrant box repackage NAME PROVIDER VERSION</td>
<td>该命令重新打包给定的 box 并将其放入当前目录，以便重新分配它。该 box 的名称，提供者和版本可以使用 vagrant box list 查看</td>
</tr>
<tr>
<td>vagrant box update</td>
<td>更新 box</td>
</tr>
</tbody>
</table>
<h2 id="destroy"><a href="#destroy" class="headerlink" title="destroy"></a>destroy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant destroy [name|id]</span><br></pre></td></tr></table></figure>
<p>该命令停止正在运行的机器Vagrant正在管理并销毁机器创建过程中创建的所有资源。运行此命令后，您的计算机应保持清洁状态，就好像您从未创建客户机一样。<br>当前登录用户系统上所有活动的Vagrant环境的状态。</p>
<h2 id="global-status"><a href="#global-status" class="headerlink" title="global-status"></a>global-status</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant global-status</span><br></pre></td></tr></table></figure>
<p>显示当前登录用户系统上所有活动的 Vagrant 环境的状态</p>
<h2 id="halt"><a href="#halt" class="headerlink" title="halt"></a>halt</h2><p>关闭正在运行的 vagrant 机器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant halt [name|id]</span><br></pre></td></tr></table></figure>
<h2 id="init"><a href="#init" class="headerlink" title="init"></a>init</h2><p>初始化一个 Vagrantfile，将当前目录初始化为 vagrant 环境，</p>
<p>如果给出第一个参数，它将预先填充 Vagrantfile 中 <code>config.vm.box</code> 的设置。</p>
<p>如果给出第二个参数，它将预先填充 Vagrantfile 中 <code>config.vm.box_url</code> 的设置。</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>–box-version</td>
<td>（可选）选定 box 的版本添加到 Vagrantfile</td>
</tr>
<tr>
<td>–force</td>
<td>如果指定，则此命令将覆盖任何现有的 Vagrantfile</td>
</tr>
<tr>
<td>–minimal</td>
<td>如果指定，将创建一个最小的 Vagrantfile。</td>
</tr>
<tr>
<td>–output FILE</td>
<td>这将输出 Vagrantfile 到给定的文件。如果这是 <code>-</code>，则 Vagrantfile 将被发送到标准输出。</td>
</tr>
<tr>
<td>–template FILE</td>
<td>提供用于生成 Vagrantfile 的自定义ERB模板。</td>
</tr>
</tbody>
</table>
<p><code>vagrant init</code> 例子</p>
<p>创建一个标准的 Vagrantfile：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vagrant init hashicorp/precise64</span><br></pre></td></tr></table></figure>
<p>创建一个最小的 Vagrantfile（没有注释和帮助）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vagrant init -m hashicorp/precise64</span><br></pre></td></tr></table></figure>
<p>创建一个新的 Vagrantfile，覆盖当前的 Vagrantfile:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vagrant init -f hashicorp/precise64</span><br></pre></td></tr></table></figure>
<p>使用指定的 url 创建一个 Vagrantfile：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vagrant init my-company-box https://boxes.company.com/my-company.box</span><br></pre></td></tr></table></figure>
<p>创建一个 Vagrantfile，并且限制版本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vagrant init --box-version &apos;&gt; 0.1.5&apos; hashicorp/precise64</span><br></pre></td></tr></table></figure>
<h2 id="package"><a href="#package" class="headerlink" title="package"></a>package</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant package [name|id]</span><br></pre></td></tr></table></figure>
<p>将当前运行的 VirtualBox 或 Hyper-V 环境打包到可重复使用的 box 文件，</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>–base NAME</td>
<td>不是打包 Vagrant 管理的 VirtualBox 机器，而是打包 VirtualBox 管理的 VirtualBox 机器。 NAME 应该是 VirtualBox GUI 中机器的名称或UUID。目前该选项仅适用于 VirtualBox。</td>
</tr>
<tr>
<td>–output NAME</td>
<td>生成的包将被保存为NAME。默认情况下，它将被保存为 package.box</td>
</tr>
<tr>
<td>–include x,y,z</td>
<td>其他文件将随包装一起打包。这些可以被打包的Vagrantfile（下面记录）用来执行其他任务。</td>
</tr>
<tr>
<td>–vagrantfile FILE</td>
<td>用框打包Vagrantfile，在 使用结果框时将其作为Vagrantfile加载次序的一部分加载。</td>
</tr>
</tbody>
</table>
<h2 id="port"><a href="#port" class="headerlink" title="port"></a>port</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant port [name|id]</span><br></pre></td></tr></table></figure>
<p>port命令显示映射到主机端口的访客端口的完整列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ vagrant port</span><br><span class="line">    22 (guest) =&gt; 2222 (host)</span><br><span class="line">    80 (guest) =&gt; 8080 (host)</span><br></pre></td></tr></table></figure>
<p>在多机Vagrantfile中，必须指定机器的名称：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vagrant port my-machine</span><br></pre></td></tr></table></figure></p>
<h2 id="reload"><a href="#reload" class="headerlink" title="reload"></a>reload</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant reload [name|id]</span><br></pre></td></tr></table></figure>
<p>停止，并重新加载 Vagrantfile ，常用于更改配置之后，重新启动，载入配置</p>
<h2 id="Suspend"><a href="#Suspend" class="headerlink" title="Suspend"></a>Suspend</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant suspend [name|id]</span><br></pre></td></tr></table></figure>
<p>暂停 Vagrant 正在管理的访客机器，而不是完全关闭或销毁它。</p>
<h2 id="Resume"><a href="#Resume" class="headerlink" title="Resume"></a>Resume</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant resume [name|id]</span><br></pre></td></tr></table></figure>
<p>恢复先前被挂起的流浪者管理的机器。</p>
<h2 id="Snapshot"><a href="#Snapshot" class="headerlink" title="Snapshot"></a>Snapshot</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant snapshot</span><br></pre></td></tr></table></figure>
<p>为 vagrant 虚拟机打快照，以便于以后恢复到某一状态。</p>
<p><strong>子命令</strong></p>
<table>
<thead>
<tr>
<th>子命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>vagrant snapshot push</td>
<td>将当前虚拟机状态打成快照，并推送到快照栈</td>
</tr>
<tr>
<td>vagrant snapshot pop</td>
<td>恢复之前 push 的快照状态。并删除快照</td>
</tr>
<tr>
<td>vagrant snapshot save [vm-name] NAME</td>
<td>该命令保存一个新的命名快照。如果使用此命令， 则不能安全地使用 push 和 pop 子命令</td>
</tr>
<tr>
<td>vagrant snapshot restore [vm-name] NAME</td>
<td>该命令将恢复指定的快照。</td>
</tr>
<tr>
<td>vagrant snapshot list</td>
<td>列出所有拍摄的快照</td>
</tr>
<tr>
<td>vagrant snapshot delete NAME</td>
<td>删除命名的快照</td>
</tr>
</tbody>
</table>
<h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant ssh [name|id] [-- extra_ssh_args]</span><br></pre></td></tr></table></figure>
<p>这将SSH连接到正在运行的Vagrant机器，并允许您访问 SHELL 。</p>
<h2 id="status"><a href="#status" class="headerlink" title="status"></a>status</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant status [name|id]</span><br></pre></td></tr></table></figure>
<p>这会告诉你Vagrant正在管理的机器的状态</p>
<h2 id="up"><a href="#up" class="headerlink" title="up"></a>up</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant up [name|id]</span><br></pre></td></tr></table></figure>
<p>启动 vagrant 虚拟机</p>
<h2 id="vagrant-多台主机"><a href="#vagrant-多台主机" class="headerlink" title="vagrant 多台主机"></a>vagrant 多台主机</h2><p>在同一个项目 Vagrantfile 中定义多台机器 <code>config.vm.define</code> ,<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- mode: ruby -*-</span></span><br><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> <span class="params">|config|</span></span><br><span class="line">  config.hostmanager.enabled = <span class="literal">true</span></span><br><span class="line">  config.hostmanager.manage_host = <span class="literal">true</span></span><br><span class="line">  config.hostmanager.manage_guest = <span class="literal">true</span></span><br><span class="line">  config.hostmanager.ignore_private_ip = <span class="literal">false</span></span><br><span class="line">  config.hostmanager.include_offline = <span class="literal">true</span></span><br><span class="line">  config.vm.provision <span class="string">"shell"</span>, <span class="symbol">inline:</span> <span class="string">"echo Hello"</span></span><br><span class="line">  config.vm.define <span class="string">"node1"</span> <span class="keyword">do</span> <span class="params">|node1|</span></span><br><span class="line">    node1.vm.hostname = <span class="string">'node1'</span></span><br><span class="line">    node1.vm.box = <span class="string">"centos/7"</span></span><br><span class="line">    node1.vm.network <span class="string">"private_network"</span>,<span class="symbol">ip:</span> <span class="string">"10.0.100.101"</span></span><br><span class="line">      config.vm.provider <span class="string">"virtualbox"</span> <span class="keyword">do</span> <span class="params">|vb|</span></span><br><span class="line">        vb.memory = <span class="string">"1024"</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  config.vm.define <span class="string">"node2"</span> <span class="keyword">do</span> <span class="params">|node2|</span></span><br><span class="line">    node2.vm.hostname = <span class="string">'node2'</span></span><br><span class="line">    node2.vm.box = <span class="string">"centos/7"</span></span><br><span class="line">    node2.vm.network <span class="string">"private_network"</span>,<span class="symbol">ip:</span> <span class="string">"10.0.100.102"</span></span><br><span class="line">      config.vm.provider <span class="string">"virtualbox"</span> <span class="keyword">do</span> <span class="params">|vb|</span></span><br><span class="line">        vb.memory = <span class="string">"1024"</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  config.vm.define <span class="string">"node3"</span> <span class="keyword">do</span> <span class="params">|node3|</span></span><br><span class="line">    node3.vm.hostname = <span class="string">'node3'</span></span><br><span class="line">    node3.vm.box = <span class="string">"centos/7"</span></span><br><span class="line">    node3.vm.network <span class="string">"private_network"</span>,<span class="symbol">ip:</span> <span class="string">"10.0.100.103"</span></span><br><span class="line">      config.vm.provider <span class="string">"virtualbox"</span> <span class="keyword">do</span> <span class="params">|vb|</span></span><br><span class="line">        vb.memory = <span class="string">"1024"</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="控制多台机器"><a href="#控制多台机器" class="headerlink" title="控制多台机器"></a>控制多台机器</h3><p>当 Vagrantfile 中定义了多台机器时，各种 vagrant 命令的用法稍有变化。改变应该是直观的。</p>
<p>只有目标单个机器才有意义的命令，例如 <code>vagrant ssh</code>，现在需要机器的名称来控制。使用上面的例子，你会说 <code>vagrant ssh web</code> 或 <code>vagrant ssh db</code>。</p>
<p>其他命令（例如 <code>vagrant up</code>，默认情况下在每台机器上运行）。所以如果你跑了 vagrant up，Vagrant会同时启动 Web 和 DB 机器。你也可以指定启动的机器，使用 <code>vagrant up web</code> 或  <code>vagrant up db</code>。</p>
<p>此外，您可以指定一个正则表达式来仅匹配某些机器。这是在你指定许多类似的机器，例如，如果你正在测试一个分布式的服务你可能有一些情况下是有用 leader 的机器，以及 <code>follower0</code>，<code>follower1</code>，<code>follower2</code> 如果你想调出所有的追随者，但等不得的领导者，你可以做 <code>vagrant up /follower[0-9]/</code>。如果Vagrant 在正斜杠内看到一个机器名称，它假定您正在使用正则表达式。</p>
<h3 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h3><p>为了促进多机设置中机器间的通信，应使用各种网络选项。特别是，专用网络(<code>private network</code>) 可用于在多台机器和主机之间建立专用网络。</p>
<h3 id="自启动"><a href="#自启动" class="headerlink" title="自启动"></a>自启动</h3><p>默认情况下，在多机环境中，vagrant up将启动所有定义的机器。该autostart设置允许您告诉Vagrant 不启动特定机器。例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">config.vm.define &quot;web&quot;</span><br><span class="line">config.vm.define &quot;db&quot;</span><br><span class="line">config.vm.define &quot;db_follower&quot;, autostart: false</span><br></pre></td></tr></table></figure></p>
<h2 id="Vagrant-Plugin"><a href="#Vagrant-Plugin" class="headerlink" title="Vagrant Plugin"></a>Vagrant Plugin</h2><p>中国地区下载插件方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vagrant plugin install vagrant-vbguest  vagrant-hostmanager --plugin-clean-sources --plugin-source https://gems.ruby-china.org/</span><br><span class="line">vagrant reload</span><br></pre></td></tr></table></figure></p>
<h2 id="CentOS-自定义镜像错误"><a href="#CentOS-自定义镜像错误" class="headerlink" title="CentOS 自定义镜像错误"></a>CentOS 自定义镜像错误</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Vagrant was unable to mount VirtualBox shared folders. This is usually</span><br><span class="line">because the filesystem &quot;vboxsf&quot; is not available. This filesystem is</span><br><span class="line">made available via the VirtualBox Guest Additions and kernel module.</span><br><span class="line">Please verify that these guest additions are properly installed in the</span><br><span class="line">guest. This is not a bug in Vagrant and is usually caused by a faulty</span><br><span class="line">Vagrant box. For context, the command attempted was:</span><br><span class="line"></span><br><span class="line">mount -t vboxsf -o uid=1000,gid=1000 vagrant /vagrant</span><br><span class="line"></span><br><span class="line">The error output from the command was:</span><br><span class="line"></span><br><span class="line">/sbin/mount.vboxsf: mounting failed with the error: No such device</span><br></pre></td></tr></table></figure>
<p>解决方法，进入虚拟机安装以下软件包，需要注意当前 kernel 版本和 <code>kernel-headers</code>,<code>kernel-devel</code> 对应<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vagrant ssh</span><br><span class="line">yum -y update</span><br><span class="line">yum -y install kernel-headers kernel-devel</span><br><span class="line">sudo /opt/VBoxGuestAdditions-*/init/vboxadd setup</span><br></pre></td></tr></table></figure></p>
<p>或者下载 1804 版本的 box</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">kuops</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://kuops.com/2018/05/03/Vagrant-常用命令/">https://kuops.com/2018/05/03/Vagrant-常用命令/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://kuops.com" target="_blank">Kuops Blog</a>！</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/05/13/Vagrant-和-VirtualBox-设置/"><i class="fa fa-chevron-left">  </i><span>Vagrant 和 VirtualBox 设置</span></a></div><div class="next-post pull-right"><a href="/2018/05/02/使用-WSL-操作-Vagrant/"><span>使用 WSL 操作 Vagrant</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="disqus_thread"></div><script>var unused = null;
var disqus_config = function () {
  this.page.url = 'https://kuops.com/2018/05/03/Vagrant-常用命令/';
  this.page.identifier = '2018/05/03/Vagrant-常用命令/';
  this.page.title = 'Vagrant 常用命令';
}
var d = document, s = d.createElement('script');
s.src = "https://" + 'kuops-com' +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2019 By kuops</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.4"></script><script src="/js/fancybox.js?version=1.5.4"></script><script src="/js/sidebar.js?version=1.5.4"></script><script src="/js/copy.js?version=1.5.4"></script><script src="/js/fireworks.js?version=1.5.4"></script><script src="/js/transition.js?version=1.5.4"></script><script src="/js/scroll.js?version=1.5.4"></script><script src="/js/head.js?version=1.5.4"></script></body></html>